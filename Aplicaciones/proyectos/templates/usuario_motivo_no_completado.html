{% extends "./plantilla.html" %}
{% load static %}
{% block contenido %}

<style>
  body{
    background-color:#000;
  }

  .box-justificar{
    width:92%;
    max-width:720px;
    margin:50px auto;
    background:#111827;
    color:#F9FAFB;
    padding:26px 26px 22px;
    border-radius:20px;
    border:1px solid #1F2937;
    box-shadow:0 18px 40px rgba(0,0,0,0.55);
    font-family:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  }

  .box-justificar h3{
    margin:0 0 4px 0;
    font-weight:800;
    text-align:center;
    font-size:22px;
  }
  .subtitulo{
    text-align:center;
    font-size:13px;
    color:#9CA3AF;
    margin-bottom:18px;
  }
  .pill-estado{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:4px 10px;
    border-radius:999px;
    background:#075985;          
    color:#E0F2FE;
    font-size:11px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:.04em;
    margin-bottom:16px;
  }

  .evento-card{
    background:#020617;
    border-radius:14px;
    border:1px solid #1F2937;
    padding:14px 14px 10px;
    margin-bottom:18px;
  }
  .evento-titulo{
    font-weight:600;
    font-size:14px;
    margin-bottom:10px;
  }
  .evento-meta{
    display:grid;
    grid-template-columns:repeat(2,minmax(0,1fr));
    gap:6px 18px;
    font-size:12px;
  }
  .evento-meta span.label{
    display:block;
    font-size:11px;
    text-transform:uppercase;
    letter-spacing:.05em;
    color:#6B7280;
    margin-bottom:1px;
  }
  .evento-meta span.valor{
    color:#E5E7EB;
    font-weight:500;
  }

  hr{
    border:none;
    border-top:1px solid #1F2937;
    margin:14px 0 16px;
  }

  .campo-motivo-label{
    font-size:13px;
    font-weight:600;
    margin-bottom:6px;
    display:block;
  }
  .campo-motivo-help{
    font-size:11px;
    color:#9CA3AF;
    margin-bottom:8px;
  }

  textarea{
    width:100%;
    min-height:130px;
    border-radius:12px;
    border:1px solid #1F2937;
    background:#020617;
    color:#F9FAFB;
    padding:10px 11px;
    resize:vertical;
    font-size:13px;
  }
  textarea::placeholder{
    color:#6B7280;
    font-size:12px;
  }
  textarea:focus{
    outline:none;
    border-color:#3B82F6;
    box-shadow:0 0 0 2px rgba(59,130,246,0.4);
  }

  .acciones{
    margin-top:14px;
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:flex-end;
  }

  .btn-primary{
    padding:10px 20px;
    border-radius:999px;
    border:none;
    background:#3B82F6;
    color:#fff;
    font-weight:700;
    cursor:pointer;
    min-width:200px;
    font-size:13px;
    box-shadow:0 10px 22px rgba(37,99,235,0.6);
    transition:transform .08s ease-out, box-shadow .08s ease-out, background .08s;
  }

  .btn-primary:hover{
    background:#2563EB;
    transform:translateY(-1px);
    box-shadow:0 14px 28px rgba(37,99,235,0.8);
  }

  .btn-secondary{
    padding:10px 20px;
    border-radius:999px;
    border:none;
    background:#4B5563;
    color:#F9FAFB;
    font-weight:700;
    cursor:pointer;
    font-size:13px;
    text-decoration:none;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-width:120px;
    transition:background .08s, transform .08s ease-out, box-shadow .08s;
  }
  
  .btn-secondary:hover{
    background:#374151;
    transform:translateY(-1px);
    box-shadow:0 10px 20px rgba(15,23,42,0.8);
  }

  @media (max-width:600px){
    .box-justificar{
      margin:24px auto;
      padding:18px 14px 16px;
    }
    .evento-meta{
      grid-template-columns:1fr;
    }
    .btn-primary{
      width:100%;
    }
    .btn-secondary{
      width:100%;
    }
    .acciones{
      justify-content:center;
      align-items:stretch;
    }
  }
</style>

<div class="box-justificar">
  <h3>Motivo de No completado</h3>
  <div class="subtitulo">
    Indica por qué el evento no pudo completarse.
  </div>

  <div class="pill-estado">
    <span>●</span> Estado actual: NO COMPLETADO
  </div>

  <!-- Tarjeta con info del evento -->
  <div class="evento-card">
    <div class="evento-titulo">
      {{ asign.evento.titulo }}
    </div>
    <div class="evento-meta">
      <div>
        <span class="label">Inicio</span>
        <span class="valor">
          {{ asign.evento.inicio_fecha|date:"d-m-Y" }}
          · {{ asign.evento.inicio_hora|time:"h:i A" }}
        </span>
      </div>
      {% if asign.evento.fin_fecha and asign.evento.fin_hora %}
      <div>
        <span class="label">Fin</span>
        <span class="valor">
          {{ asign.evento.fin_fecha|date:"d-m-Y" }}
          · {{ asign.evento.fin_hora|time:"h:i A" }}
        </span>
      </div>
      {% endif %}
    </div>
  </div>

  <form method="POST">
    {% csrf_token %}

    <label for="motivo" class="campo-motivo-label">
      Escribe el motivo por el que el evento quedó NO COMPLETADO:
    </label>
    <div class="campo-motivo-help">
      Ejemplo: el vehículo nunca salió, el conductor se enfermó, hubo cambio de ruta no autorizado, etc.
    </div>

    <textarea id="motivo" name="motivo" required
              placeholder="Ejemplo: El viaje fue cancelado por mantenimiento del vehículo y no se realizó ninguna parte del recorrido.">
      {{ motivo_actual }}
    </textarea>

    <div class="acciones">
      <button type="submit" class="btn-primary">
        Guardar motivo y actualizar estado
      </button>

      <a href="{% url 'pedidosusuario' %}" class="btn-secondary">
        Cancelar
      </a>
    </div>
  </form>
</div>

{% endblock %}
