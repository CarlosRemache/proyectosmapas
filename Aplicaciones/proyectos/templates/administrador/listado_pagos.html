{% extends "plantillaadministrador.html" %}
{% load static %}
{% block contener %}

<style>
  body{ background:#ffffff; }

  .box{
    width:92%;
    max-width:1100px;
    margin:30px auto;
    background:#06080D;
    color:#F3F4F6;
    padding:22px;
    border-radius:18px;
    margin-left:380px;
    border:1px solid #1F2937;
    box-shadow:0 12px 30px rgba(0,0,0,0.4);
  }

  .box h3{
    margin-bottom:20px;
    font-weight:700;
    text-align:center;
  }

  .table-responsive{
    width:100%;
    border-radius:14px;
    border:1px solid #1F2937;
    background:#111827;
    padding:12px;
    overflow:auto;
  }

  /* DATATABLES */
  .dt-buttons{
    text-align:right;
    margin-bottom:12px;
  }

  .dt-buttons .dt-button{
    padding:10px 14px;
    border-radius:10px;
    border:1px solid #1F2937;
    background:#3B82F6;
    color:#ffffff;
    font-weight:700;
    margin-left:8px;
  }

  .dt-buttons .dt-button:hover{
    background:#2563EB;
  }

  #tabla_pagos{
    width:100%;
    font-size:13px;
    color:#F3F4F6;
  }

  #tabla_pagos thead th{
    background:#06080D;
    color:#F3F4F6;
    border-bottom:1px solid #1F2937;
    padding:10px;
    white-space:nowrap;
  }

  #tabla_pagos tbody td{
    background:#111827;
    color:#F3F4F6;
    border-top:1px solid #1F2937;
    padding:10px;
    text-align:center;
    white-space:nowrap;
  }

  #tabla_pagos tbody tr:hover td{
    background:#0B1220;
  }

  /* BOTONES */
  .btn-ver{
    background:#10B981;
    color:#000;
    padding:6px 12px;
    border-radius:8px;
    font-weight:700;
    text-decoration:none;
    margin-right:6px;
  }

  .btn-ver:hover{ background:#059669; }

  .btn-editar{
    background:#F59E0B;
    color:#000;
    padding:6px 12px;
    border-radius:8px;
    font-weight:700;
    text-decoration:none;
    margin-right:6px;
  }

  .btn-editar:hover{ background:#D97706; }

  .btn-eliminar{
    background:#EF4444;
    color:#fff;
    padding:6px 12px;
    border-radius:8px;
    font-weight:700;
    text-decoration:none;
  }

  .btn-eliminar:hover{ background:#DC2626; }

  @media (max-width:1200px){
    .box{ margin-left:0; width:96%; }
    .dt-buttons{ text-align:left; }
  }
</style>

<div class="box">
  <h3>Listado de Pagos</h3>

  <div class="table-responsive">
    <table class="table table-bordered table-striped" id="tabla_pagos">
      <thead>
        <tr>
          <th>ID</th>
          <th>Factura</th>
          <th>MÃ©todo</th>
          <th>Monto</th>
          <th>Banco</th>
          <th>Estado</th>
          <th>Fecha</th>
          <th>Comprobante</th>
          <th>Acciones</th>
        </tr>
      </thead>

      <tbody>
        {% for p in pagos %}
        <tr>
          <td>{{ p.id_pago }}</td>
          <td>{{ p.factura.numero_factura }}</td>
          <td>{{ p.metodo_pago }}</td>
          <td>$ {{ p.monto_pagado }}</td>
          <td>{{ p.banco|default:"-" }}</td>
          <td>{{ p.estado_pago }}</td>
          <td>{{ p.fecha_pago|date:"Y-m-d H:i" }}</td>
          <td>
            {% if p.comprobante %}
              <a href="{{ p.comprobante.url }}" target="_blank">
                <img src="{{ p.comprobante.url }}"
                    style="height:45px; border-radius:6px; border:1px solid #1F2937;">
              </a>
            {% else %}
              -
            {% endif %}
          </td>          
          <td>
            <a href="{% url 'ver_pago' p.id_pago %}" class="btn-ver">Ver</a>
            <a href="{% url 'editar_pago' p.id_pago %}" class="btn-editar">Editar</a>
            <a href="{% url 'eliminar_pago' p.id_pago %}" class="btn-eliminar">
              Eliminar
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>

    </table>
  </div>
</div>

<script>
$(document).ready(function() {
  $('#tabla_pagos').DataTable({
    dom: 'Bfrtip',
    buttons: [
      { extend: 'copy', text: 'Copiar' },
      { extend: 'excel', text: 'Excel' },
      { extend: 'csv', text: 'CSV' },
      { extend: 'pdf', text: 'PDF', orientation: 'landscape', pageSize: 'A4' }
    ],
    language: {
      url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json",
      search: "Buscar:",
      lengthMenu: "Mostrar _MENU_ registros",
      info: "Mostrando _START_ a _END_ de _TOTAL_ registros",
      infoEmpty: "Mostrando 0 a 0 de 0 registros",
      infoFiltered: "(filtrado de _MAX_ registros totales)",
      paginate: {
        previous: "Anterior",
        next: "Siguiente"
      },
      zeroRecords: "No se encontraron resultados"
    }
  });
});
</script>

{% endblock %}
